<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="740px" preserveAspectRatio="none" style="width:1515px;height:740px;background:#FFFFFF;" version="1.1" viewBox="0 0 1515 740" width="1515px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="637.9766" style="stroke:#181818;stroke-width:1.0;" width="10" x="41" y="47.6094"/><rect fill="#FFFFFF" height="615.625" style="stroke:#181818;stroke-width:1.0;" width="10" x="258" y="69.9609"/><rect fill="#FFFFFF" height="554.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="726" y="100.3125"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="993" y="130.6641"/><rect fill="#FFFFFF" height="147.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="993" y="449.8281"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1087" y="268.0703"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1196.5" y="480.1797"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1196.5" y="568.8828"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1196.5" y="627.2344"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1343.5" y="524.5313"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1466.5" y="405.4766"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="792.5" x="10" y="159.6641"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="792.5" x="10" y="297.0703"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="46" x2="46" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="730.5" x2="730.5" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="997.5" x2="997.5" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1091.5" x2="1091.5" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1201.5" x2="1201.5" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1348.5" x2="1348.5" y1="37.6094" y2="703.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1471.5" x2="1471.5" y1="37.6094" y2="703.5859"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="27" y="26.5332">Route</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="20" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="27" y="724.1191">Route</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="194" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="201" y="26.5332">MapaPisoController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="194" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="201" y="724.1191">MapaPisoController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="669.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="676.5" y="26.5332">MapaPisoService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="669.5" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="676.5" y="724.1191">MapaPisoService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="951.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="958.5" y="26.5332">MapisoRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="951.5" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="958.5" y="724.1191">MapisoRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75" x="1054.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1061.5" y="26.5332">PisoRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75" x="1054.5" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1061.5" y="724.1191">PisoRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="1139.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1146.5" y="26.5332">MapaPisoMapper</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="1139.5" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1146.5" y="724.1191">MapaPisoMapper</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="1273.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="1280.5" y="26.5332">MapaPisoPersistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150" x="1273.5" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="1280.5" y="724.1191">MapaPisoPersistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="1433.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1440.5" y="26.5332">MapaPiso</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="1433.5" y="702.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1440.5" y="724.1191">MapaPiso</text><rect fill="#FFFFFF" height="637.9766" style="stroke:#181818;stroke-width:1.0;" width="10" x="41" y="47.6094"/><rect fill="#FFFFFF" height="615.625" style="stroke:#181818;stroke-width:1.0;" width="10" x="258" y="69.9609"/><rect fill="#FFFFFF" height="554.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="726" y="100.3125"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="993" y="130.6641"/><rect fill="#FFFFFF" height="147.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="993" y="449.8281"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1087" y="268.0703"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1196.5" y="480.1797"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1196.5" y="568.8828"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1196.5" y="627.2344"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1343.5" y="524.5313"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1466.5" y="405.4766"/><polygon fill="#181818" points="246,65.9609,256,69.9609,246,73.9609,250,69.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="51" x2="252" y1="69.9609" y2="69.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="58" y="65.1045">/createMapaPiso</text><polygon fill="#181818" points="714,96.3125,724,100.3125,714,104.3125,718,100.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="268" x2="720" y1="100.3125" y2="100.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="275" y="95.4561">createMapaPiso(IMapaPisoDTO)</text><polygon fill="#181818" points="981,126.6641,991,130.6641,981,134.6641,985,130.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="736" x2="987" y1="130.6641" y2="130.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="743" y="125.8076">findByDomainId(mapaPisoDTO.domainId)</text><polygon fill="#181818" points="747,140.6641,737,144.6641,747,148.6641,743,144.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="741" x2="997" y1="144.6641" y2="144.6641"/><path d="M10,159.6641 L71,159.6641 L71,168.0156 L61,178.0156 L10,178.0156 L10,159.6641 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="792.5" x="10" y="159.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="174.1592">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="86" y="173.083">[mapaPiso existe]</text><polygon fill="#181818" points="279,196.3672,269,200.3672,279,204.3672,275,200.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="273" x2="725" y1="200.3672" y2="200.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422" x="285" y="195.5107">Envia erro com a mensagem: Já existe um mapa de piso com o código X</text><polygon fill="#181818" points="62,226.7188,52,230.7188,62,234.7188,58,230.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56" x2="257" y1="230.7188" y2="230.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="68" y="225.8623">Envia status 403 (FORBIDDEN)</text><polygon fill="#181818" points="1075,264.0703,1085,268.0703,1075,272.0703,1079,268.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="736" x2="1081" y1="268.0703" y2="268.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="743" y="263.2139">findByDesignacao(mapaPisoDTO.piso)</text><polygon fill="#181818" points="747,278.0703,737,282.0703,747,286.0703,743,282.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="741" x2="1091" y1="282.0703" y2="282.0703"/><path d="M10,297.0703 L71,297.0703 L71,305.4219 L61,315.4219 L10,315.4219 L10,297.0703 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:1.5;" width="792.5" x="10" y="297.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="311.5654">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="147" x="86" y="310.4893">[piso não existe/é inválido]</text><polygon fill="#181818" points="279,333.7734,269,337.7734,279,341.7734,275,337.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="273" x2="725" y1="337.7734" y2="337.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="434" x="285" y="332.917">Envia erro com a mensagem: Não existe nenhum piso com a designação X</text><polygon fill="#181818" points="62,364.125,52,368.125,62,372.125,58,368.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56" x2="257" y1="368.125" y2="368.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="68" y="363.2686">Envia status 403 (FORBIDDEN)</text><polygon fill="#181818" points="1454.5,401.4766,1464.5,405.4766,1454.5,409.4766,1458.5,405.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="736" x2="1460.5" y1="405.4766" y2="405.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="743" y="400.6201">mapaPiso = create(mapaPisoDTO)</text><polygon fill="#181818" points="747,415.4766,737,419.4766,747,423.4766,743,419.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="741" x2="1470.5" y1="419.4766" y2="419.4766"/><polygon fill="#181818" points="981,445.8281,991,449.8281,981,453.8281,985,449.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="736" x2="987" y1="449.8281" y2="449.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="743" y="444.9717">save(mapaPiso)</text><polygon fill="#181818" points="1184.5,476.1797,1194.5,480.1797,1184.5,484.1797,1188.5,480.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1003" x2="1190.5" y1="480.1797" y2="480.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1010" y="475.3232">toPersistence(mapaPiso)</text><polygon fill="#181818" points="1014,490.1797,1004,494.1797,1014,498.1797,1010,494.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1008" x2="1200.5" y1="494.1797" y2="494.1797"/><polygon fill="#181818" points="1331.5,520.5313,1341.5,524.5313,1331.5,528.5313,1335.5,524.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1003" x2="1337.5" y1="524.5313" y2="524.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="1010" y="519.6748">create(mapaPisoCreated)</text><polygon fill="#181818" points="1014,534.5313,1004,538.5313,1014,542.5313,1010,538.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1008" x2="1347.5" y1="538.5313" y2="538.5313"/><polygon fill="#181818" points="1184.5,564.8828,1194.5,568.8828,1184.5,572.8828,1188.5,568.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1003" x2="1190.5" y1="568.8828" y2="568.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1010" y="564.0264">toDomain(mapaPisoCreated)</text><polygon fill="#181818" points="1014,578.8828,1004,582.8828,1014,586.8828,1010,582.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1008" x2="1200.5" y1="582.8828" y2="582.8828"/><polygon fill="#181818" points="747,592.8828,737,596.8828,747,600.8828,743,596.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="741" x2="997" y1="596.8828" y2="596.8828"/><polygon fill="#181818" points="1184.5,623.2344,1194.5,627.2344,1184.5,631.2344,1188.5,627.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="736" x2="1190.5" y1="627.2344" y2="627.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="743" y="622.3779">toDTO(mapaPiso)</text><polygon fill="#181818" points="747,637.2344,737,641.2344,747,645.2344,743,641.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="741" x2="1200.5" y1="641.2344" y2="641.2344"/><polygon fill="#181818" points="279,651.2344,269,655.2344,279,659.2344,275,655.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="273" x2="730" y1="655.2344" y2="655.2344"/><polygon fill="#181818" points="57,681.5859,47,685.5859,57,689.5859,53,685.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51" x2="262" y1="685.5859" y2="685.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="63" y="680.7295">Envia um código 201 (OK)</text><!--MD5=[c75f2feca8306f7a020793d5d28df754]
@startuml sd

participant Route as route
participant MapaPisoController as ctrl
participant MapaPisoService as svc
participant MapisoRepo as repoMap
participant PisoRepo as repoPis
participant MapaPisoMapper as mapper
participant MapaPisoPersistence as pers
participant MapaPiso as model

activate route
route -> ctrl : /createMapaPiso
activate ctrl
ctrl -> svc : createMapaPiso(IMapaPisoDTO)
activate svc
svc -> repoMap : findByDomainId(mapaPisoDTO.domainId)
activate repoMap
repoMap - -> svc
deactivate repoMap
alt mapaPiso existe
    svc - -> ctrl : Envia erro com a mensagem: Já existe um mapa de piso com o código X
    ctrl - -> route : Envia status 403 (FORBIDDEN)
end
svc -> repoPis : findByDesignacao(mapaPisoDTO.piso)
activate repoPis
repoPis - -> svc
deactivate repoPis
alt piso não existe/é inválido
    svc - -> ctrl : Envia erro com a mensagem: Não existe nenhum piso com a designação X
    ctrl - -> route : Envia status 403 (FORBIDDEN)
end
svc -> model : mapaPiso = create(mapaPisoDTO)
activate model
model - -> svc
deactivate model
svc -> repoMap : save(mapaPiso)
activate repoMap
repoMap -> mapper : toPersistence(mapaPiso)
activate mapper
mapper - -> repoMap
deactivate mapper
repoMap -> pers : create(mapaPisoCreated)
activate pers
pers - -> repoMap
deactivate pers
repoMap -> mapper : toDomain(mapaPisoCreated)
activate mapper
mapper - -> repoMap
deactivate mapper
repoMap - -> svc
deactivate repoMap
svc -> mapper : toDTO(mapaPiso)
activate mapper
mapper - -> svc
deactivate mapper
svc - -> ctrl
deactivate svc
ctrl - -> route : Envia um código 201 (OK)
deactivate ctrl
deactivate route



@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>